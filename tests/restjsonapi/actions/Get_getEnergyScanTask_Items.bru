meta {
  name: Get getEnergyScanTask Items
  type: http
  seq: 1
}

get {
  url: {{protocol}}://{{host}}:{{port}}{{base_path}}/actions?fields[getEnergyScanTask]
  body: json
  auth: none
}

query {
  fields[getEnergyScanTask]: 
}

headers {
  Accept: application/vnd.api+json
}

assert {
  res.headers['content-type']: eq application/vnd.api+json
  res.body: isJson
  res.status: eq 200
  res.body.meta.collection: isDefined
  res.body.meta.collection.total: gte 1
  res.body.data: isArray
  res.body.data[0].id: isDefined
  res.body.data[0].type: eq "getEnergyScanTask"
  res.body.data[0].attributes: isDefined
}

tests {
  
  test("Data contains fields requested", function() {
    const data = res.getBody().data;
    expect(data).to.be.an.instanceOf(Array);
    for (let i=0; i < data.length; i++){
      item = data[i];
      expect(item).to.have.property("id");
      expect(item).to.have.property("type");
      expect(item.type).to.equal("getEnergyScanTask");
      expect(item).to.have.property("attributes");
      expect(item.attributes).to.have.property("status");
      expect(["pending", "active", "completed", "stopped", "failed"]).to.include(item.attributes.status);
      expect(item.attributes).to.have.property("created");
      expect(item.attributes.created).to.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|[+-]\d{2}:\d{2})$/);
    }
  });
  
}

docs {
  Return all items of type getEnergyScanTask stored in the Actions Collection.
}
